<div class="receiptTitleLine">
  <div class="title">Чеки</div>
  <div class="calendar">
    <i class="pi pi-calendar"></i>
    <span>Дата:</span>
    <p-calendar
      [ngModel]="date"
      [yearRange]="'2021:2040'"
      [appendTo]="'body'"
      (ngModelChange)="onDateChange($event)"
      [readonlyInput]="true"
    ></p-calendar>
  </div>
</div>

<p-table
  [value]="(receipts | async)!"
  [lazy]="true"
  (onLazyLoad)="loadReceipts($event)"
  responsiveLayout="scroll"
  dataKey="id"
  [paginator]="true"
  [totalRecords]="(count | async)!"
  [loading]="(loading | async)!"
  [scrollable]="true"
  tableStyleClass="receiptsTable"
>
  <ng-template pTemplate="header">
    <tr class="recieptTHead">
      <th style="min-width: 180px">Фiск. номер</th>
      <th style="min-width: 180px">Тип</th>
      <th style="min-width: 100px">Сума</th>
      <th style="min-width: 200px">Дата створення</th>
      <th style="min-width: 50px"></th>
      <th style="min-width: 50px"></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-receipt>
    <tr class="recieptTBody">
      <td style="min-width: 180px">{{ receipt.orderTaxNum }}</td>
      <td style="min-width: 180px">{{ receipt.receiptType }}</td>
      <td style="min-width: 100px">{{ receipt.sum }}</td>
      <td style="min-width: 200px">
        {{ receipt.dateCreate | date: "dd.MM.YYYY" }}
      </td>
      <td style="min-width: 50px">
        <a
          class="receiptBtn"
          [attr.href]="receipt.dfsLink"
          title="Посилання на сайт"
          target="_blank"
          ><i class="pi pi-link"></i>Сайт</a
        >
      </td>
      <td style="min-width: 50px">
        <button
          class="receiptBtn"
          title="Перегляд чеку"
          (click)="onSelectReceipt(receipt.orderTaxNum)"
        >
          <i class="pi pi-eye"></i> Чек
        </button>
      </td>
    </tr>
  </ng-template>
</p-table>

<p-dialog
  header="Чек"
  [(visible)]="visibleReceipt"
  [style]="{ width: '330px' }"
>
  <app-receipt
    *ngIf="fiscalNumber != null"
    [fiscalNumber]="fiscalNumber"
    showMode="print"
  ></app-receipt>
</p-dialog>
