<div class="container">
  <p-table
    [value]="(receipts | async)!"
    [lazy]="true"
    (onLazyLoad)="loadReceipts($event)"
    responsiveLayout="scroll"
    dataKey="id"
    [paginator]="true"
    [rows]="20"
    [totalRecords]="(count | async)!"
    [loading]="(loading | async)!"
    [scrollable]="true"
    scrollHeight="flex"
  >
    <ng-template pTemplate="caption">
      <div class="title">Чеки</div>
      <div class="rightCaption">
        <p-calendar
          [ngModel]="date"
          [yearRange]="'2021:2040'"
          [appendTo]="'body'"
          (ngModelChange)="onDateChange($event)"
        ></p-calendar>
      </div>
    </ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th>Фiск. номер</th>
        <th>Тип</th>
        <th>Сума</th>
        <th>Дата створення</th>
        <th></th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-receipt>
      <tr>
        <td>{{ receipt.orderTaxNum }}</td>
        <td>{{ receipt.receiptType }}</td>
        <td>{{ receipt.sum }}</td>
        <td>{{ receipt.dateCreate }}</td>
        <td>
          <a
            [attr.href]="receipt.dfsLink"
            title="Посилання на сайт"
            target="_blank"
            ><i class="pi pi-link"></i
          ></a>
        </td>
        <td>
          <p-button
            [style]="{ width: '100%' }"
            icon="pi pi-print"
            title="Перегля чеку"
            (onClick)="onSelectReceipt(receipt.orderTaxNum)"
          ></p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-dialog
  header="Чек"
  [(visible)]="visibleReceipt"
  [style]="{ width: '600px' }"
>
  <app-receipt [fiscalNumber]="fiscalNumber" showMode="print"></app-receipt>
</p-dialog>
