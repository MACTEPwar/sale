"use strict";(self.webpackChunksale=self.webpackChunksale||[]).push([[5],{5:function(X,C,p){p.r(C),p.d(C,{ReportModule:function(){return $}});var u=p(1116),s=p(1846),t=p(4107),S=function(){function e(){}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[u.ez,s.U$]]}),e}(),g=p(971),m=p(5427),U=function(){function e(){}return e.prototype.ngOnInit=function(){},e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-report"]],decls:1,vars:0,template:function(n,o){1&n&&t._UZ(0,"router-outlet")},directives:[m.lC],styles:[""]}),e}(),d=p(529),l=p(8512),f=p(9996),h=p(611),T=p(2693),R=function(){function e(i){this.httpClient=i,this.receipts=new l.X([]),this.count=new l.X(0),this.loading=new l.X(!1)}return e.prototype.getReceipts=function(i){var n=this;this.loading.next(!0),this.httpClient.post(d.N.apiUrl+"/api/documents/list?dateTime="+i.dateTime.toISOString(),{skip:i.skip,take:i.take}).pipe((0,f.U)(function(o){return o.data}),(0,h.q)(1)).subscribe(function(o){n.receipts.next(o.Value),n.count.next(o.Key),n.loading.next(!1)})},e.\u0275fac=function(n){return new(n||e)(t.LFG(T.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e}(),v=p(2290),y=p(322),F=p(7633),A=function(){function e(i,n){this.httpClient=i,this.messageService=n,this.receipt=new F.w,this.contentForPrint=new l.X([])}return e.prototype.getReceipt=function(i){var n=this;void 0===i&&(i=null),this.getReceiptByFiscalNumber$(i).pipe((0,h.q)(1)).subscribe(function(o){n.receipt.totalSum.next(+o.sum),n.receipt.products.next(o.positions.map(function(c){return{articlePosition:c.articlePosition,name:c.name,amount:c.amount,price:c.price,bar:c.bar,discountSum:+c.discountSum}}))})},e.prototype.getContentForPrint=function(i){var n=this;void 0===i&&(i=null),this.getContentForPrint$(i).pipe((0,h.q)(1)).subscribe(function(o){n.contentForPrint.next(o)})},e.prototype.getContentForPrint$=function(i){return void 0===i&&(i=null),this.httpClient.get(d.N.apiUrl+"/api/service/receipt/"+i).pipe((0,f.U)(function(n){return n.data}))},e.prototype.getReceiptByFiscalNumber$=function(i){return void 0===i&&(i=null),this.httpClient.get(d.N.apiUrl+"/api/Receipt/fiscal/"+i).pipe((0,f.U)(function(n){return n.data}))},e.\u0275fac=function(n){return new(n||e)(t.LFG(T.eN),t.LFG(v.ez))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e}();function w(e,i){1&e&&(t.TgZ(0,"tr"),t.TgZ(1,"th"),t._uU(2,"\u041d\u0430\u0437\u0432\u0430"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"\u041ai\u043b\u044c\u043ai\u0441\u0442\u044c"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"\u0421\u043a\u0438\u0434\u043a\u0430"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"\u0421\u0443\u043c\u0430"),t.qZA(),t._UZ(9,"th"),t.qZA())}function b(e,i){if(1&e&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"i",5),t.qZA(),t.qZA()),2&e){var n=i.$implicit;t.xp6(2),t.Oqu(n.name),t.xp6(2),t.Oqu(n.amount),t.xp6(2),t.Oqu(n.discountSum),t.xp6(2),t.Oqu(n.amount*n.price-n.discountSum)}}function q(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"p-table",2),t.ALo(2,"async"),t.YNc(3,w,10,0,"ng-template",3),t.YNc(4,b,11,4,"ng-template",4),t.qZA(),t.BQk()),2&e){var n=t.oxw();t.xp6(1),t.Q6J("value",t.lcZ(2,1,null==n.receipt?null:n.receipt.products))}}function M(e,i){if(1&e&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"json"),t.qZA()),2&e){var n=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n)," ")}}function N(e,i){if(1&e){var n=t.EpF();t.ynx(0),t.TgZ(1,"div",6,7),t.YNc(3,M,3,3,"p",8),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"button",9),t.NdJ("click",function(){t.CHM(n);var r=t.MAs(2);return t.oxw().print(r)}),t._uU(6,"print"),t.qZA(),t.BQk()}if(2&e){var o=t.oxw();t.xp6(3),t.Q6J("ngForOf",t.lcZ(4,1,o.printContent))}}var O=function(){function e(i){this.receiptService=i,this.receipt=null,this.showMode="component",this._fiscalNumber=null,this.receipt=this.receiptService.receipt,this.printContent=this.receiptService.contentForPrint}return Object.defineProperty(e.prototype,"fiscalNumber",{get:function(){return this._fiscalNumber},set:function(i){switch(this._fiscalNumber=i,this.showMode){case"component":this.receiptService.getReceipt(i);break;case"print":this.receiptService.getContentForPrint(i)}},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.print=function(i){var n=window.open("","","left=0,top=0,width=900,height=900,toolbar=0,scrollbars=0,status=0");n.document.write("<header></header>"),n.document.write("<body>"),n.document.write(i.innerHTML),n.document.write("</body>"),setTimeout(function(){n.document.close(),n.focus(),n.print(),n.close()},2e3)},e.\u0275fac=function(n){return new(n||e)(t.Y36(A))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-receipt"]],inputs:{showMode:"showMode",fiscalNumber:"fiscalNumber"},features:[t._Bn([A])],decls:3,vars:3,consts:[[1,"container",3,"ngSwitch"],[4,"ngSwitchCase"],[3,"value"],["pTemplate","header"],["pTemplate","body"],[1,"pi","pi-edit"],["id","print-section"],["forPrint",""],[4,"ngFor","ngForOf"],[3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.YNc(1,q,5,3,"ng-container",1),t.YNc(2,N,7,3,"ng-container",1),t.qZA()),2&n&&(t.Q6J("ngSwitch",o.showMode),t.xp6(1),t.Q6J("ngSwitchCase","component"),t.xp6(1),t.Q6J("ngSwitchCase","print"))},directives:[u.RF,u.n9,s.iA,v.jx,u.sg],pipes:[u.Ov,u.Ts],styles:[""]}),e}(),_=p(1709),Z=p(1462),x=p(6726);function J(e,i){if(1&e){var n=t.EpF();t.TgZ(0,"div",7),t._uU(1,"\u0427\u0435\u043a\u0438"),t.qZA(),t.TgZ(2,"div",8),t.TgZ(3,"p-calendar",9),t.NdJ("ngModelChange",function(r){return t.CHM(n),t.oxw().onDateChange(r)}),t.qZA(),t.qZA()}if(2&e){var o=t.oxw();t.xp6(3),t.Q6J("ngModel",o.date)("yearRange","2021:2040")("appendTo","body")}}function L(e,i){1&e&&(t.TgZ(0,"tr"),t.TgZ(1,"th"),t._uU(2,"\u0424i\u0441\u043a. \u043d\u043e\u043c\u0435\u0440"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"\u0422\u0438\u043f"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"\u0421\u0443\u043c\u0430"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"\u0414\u0430\u0442\u0430 \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u044f"),t.qZA(),t._UZ(9,"th"),t._UZ(10,"th"),t.qZA())}var k=function(){return{width:"100%"}};function z(e,i){if(1&e){var n=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t.TgZ(10,"a",10),t._UZ(11,"i",11),t.qZA(),t.qZA(),t.TgZ(12,"td"),t.TgZ(13,"p-button",12),t.NdJ("onClick",function(){var a=t.CHM(n).$implicit;return t.oxw().onSelectReceipt(a.orderTaxNum)}),t.qZA(),t.qZA(),t.qZA()}if(2&e){var o=i.$implicit;t.xp6(2),t.Oqu(o.orderTaxNum),t.xp6(2),t.Oqu(o.receiptType),t.xp6(2),t.Oqu(o.sum),t.xp6(2),t.Oqu(o.dateCreate),t.xp6(2),t.uIk("href",o.dfsLink,t.LSH),t.xp6(3),t.Akn(t.DdM(7,k))}}var B=function(){return{width:"600px"}},Y=[{path:"",component:U,canActivate:[g.a],children:[{path:"receipts",component:function(){function e(i){this.receiptService=i,this.visibleReceipt=!1,this.fiscalNumber=null,this.date=new Date,this.receipts=this.receiptService.receipts,this.count=this.receiptService.count,this.loading=this.receiptService.loading,this.receiptService.getReceipts({dateTime:this.date,skip:0,take:20})}return e.prototype.ngOnInit=function(){},e.prototype.loadReceipts=function(i){this.receiptService.getReceipts({dateTime:this.date,skip:i.first,take:i.rows})},e.prototype.onDateChange=function(i){this.date=i,this.receiptService.getReceipts({dateTime:this.date,skip:0,take:20})},e.prototype.onSelectReceipt=function(i){this.fiscalNumber=i,this.visibleReceipt=!0},e.\u0275fac=function(n){return new(n||e)(t.Y36(R))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-receipts"]],features:[t._Bn([R])],decls:10,vars:18,consts:[[1,"container"],["responsiveLayout","scroll","dataKey","id","scrollHeight","flex",3,"value","lazy","paginator","rows","totalRecords","loading","scrollable","onLazyLoad"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","\u0427\u0435\u043a",3,"visible","visibleChange"],["showMode","print",3,"fiscalNumber"],[1,"title"],[1,"rightCaption"],[3,"ngModel","yearRange","appendTo","ngModelChange"],["title","\u041f\u043e\u0441\u0438\u043b\u0430\u043d\u043d\u044f \u043d\u0430 \u0441\u0430\u0439\u0442","target","_blank"],[1,"pi","pi-link"],["icon","pi pi-print","title","\u041f\u0435\u0440\u0435\u0433\u043b\u044f \u0447\u0435\u043a\u0443",3,"onClick"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"p-table",1),t.NdJ("onLazyLoad",function(r){return o.loadReceipts(r)}),t.ALo(2,"async"),t.ALo(3,"async"),t.ALo(4,"async"),t.YNc(5,J,4,3,"ng-template",2),t.YNc(6,L,11,0,"ng-template",3),t.YNc(7,z,14,8,"ng-template",4),t.qZA(),t.qZA(),t.TgZ(8,"p-dialog",5),t.NdJ("visibleChange",function(r){return o.visibleReceipt=r}),t._UZ(9,"app-receipt",6),t.qZA()),2&n&&(t.xp6(1),t.Q6J("value",t.lcZ(2,11,o.receipts))("lazy",!0)("paginator",!0)("rows",20)("totalRecords",t.lcZ(3,13,o.count))("loading",t.lcZ(4,15,o.loading))("scrollable",!0),t.xp6(7),t.Akn(t.DdM(17,B)),t.Q6J("visible",o.visibleReceipt),t.xp6(1),t.Q6J("fiscalNumber",o.fiscalNumber))},directives:[s.iA,v.jx,y.V,O,_.f,Z.JJ,Z.On,x.zx],pipes:[u.Ov],styles:[".container[_ngcontent-%COMP%]{height:100%}.container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#555;font-size:20px;height:35px}"]}),e}(),canActivate:[g.a]},{path:"z-reports",component:function(){function e(){}return e.prototype.ngOnInit=function(){},e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-z-reports"]],decls:2,vars:0,template:function(n,o){1&n&&(t.TgZ(0,"p"),t._uU(1,"z-reports works!"),t.qZA())},styles:[""]}),e}(),canActivate:[g.a]}]}],Q=function(){function e(){}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[m.Bz.forChild(Y)],m.Bz]}),e}(),$=function(){function e(){}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[u.ez,Q,s.U$,x.hJ,_._8,Z.u5,y.S,S]]}),e}()}}]);